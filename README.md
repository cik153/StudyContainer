# Network Basic Concept

> IP 주소: 네트워크 통신을 할 때 송수신지의 Identity를 정하기 위한 논리적인 값이다.
> 서브넷: 서브넷 마스크 설정을 통해 IP 주소에서 서브넷 주소를 만들어 내고, 같은 서브넷 주소끼리는 논리적으로 브로드캐스트 가능한 영역에 속하게 한다.
> L2 스위치: 서로 다른 IP 주소 간의 데이터를 송수신 하기 위한 장비
- 이더넷 프레임을 받음에 따라 동작한다. 이더넷 프레임은 송신지 MAC 주소, 수신지 MAC 주소, 페이로드, VLAN(Optional), 이더넷 타입(IPv4, IPv6 등)으로 구성된다.
- 이더넷 프레임을 받으면 MAC 주소로 목적지를 찾아 보낸다.
- 송신하려는 PC 에서 수신지의 MAC 주소를 모르면 처음에 ARP(Address Resolution Protocol, IPv4에서 사용) 또는 NDP(Neighbor Discovery Protocol, IPv6에서 사용)하여 수신지의 MAC 주소를 찾아 캐시에 저장하고, 이후 이더넷 프레임에 수신지 MAC 을 담아서 데이터를 전송한다. 이 프로토콜들은 상대 MAC 주소를 찾기 위한 프로토콜이다. 이 프로토콜 데이터를 L2 스위치에서 수신하면, 일단 스위치는 송신지의 MAC 주소를 테이블에 저장한다. 그래서 최초 수신이 없으면 연결된 NIC MAC 주소를 모른다. 그래서 저 프로토콜들은 MAC 브로드캐스트로 이더넷 프레임을 만들고, 이걸 받은 L2 스위치는 같은 VLAN(VLAN 설정이 없으면 연결된 모든 포트)에 요청을 보내고 수신한쪽은 그 프로토콜의 Target IP를 보고 자기 자신이면 자기 MAC 주소를 응답으로 보낸다. 이 응답을 받은 L2 스위치는 이더넷  프레임의 송신지를 보고 MAC 테이블에 저장하고 그 이더넷 프레임의 수신지 MAC 으로 전달한다. 그 수신지는 MAC을 요청한 곳이 될 것이고, 그 패킷에 들어있는 즉 요청한 상대 MAC 주소를 ARP 또는 NDP 캐시에 저장하고, 이후 그 MAC 주소를 송신지로 하여 이더넷 프레임을 만들고 데이터를 송신한다.
- L3 스위치: L2 스위치와 라우터를 포함하는 장비다. 서로 다른 서브넷으로 네트워크 통신을 하기 위해서는 라우터가 필요하다. 예를들어 192.168.1.XX 서브넷에서 192.168.2.XX 서브넷으로 네트워크 통신을 하기 위해서는 라우터가 필요하다. 이렇게 설계된 이유는 서브넷이 달라도 브로드캐스트가 가능하게 하면, 트래픽이 정상 동작 불가능할정도로 높아지기 때문이다. 그래서 송신지에서는 보내는 목적지 MAC 주소가 연결된 스위치의 게이트웨이 MAC 주소이다. 그 이후에 게이트웨이(라우터)에서는 최초에는 마찬가지 원리로 수신지의 MAC 주소를 찾고, 그 이후에는 안찾고 보낸다. 하지만 이 요청은 최초에 요청한 PC까지 응답을 가는게 아니라 라우터가 갖고 있는 것이다. 송신측의 PC는 스위치의 게이트웨이(라우터)로만 보내고 그 이후의 동작은 모른다.

---
